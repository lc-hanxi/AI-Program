<!-- pages/training/workout/workout.wxml -->
<view class="container">
  <!-- è®­ç»ƒè¿›è¡Œä¸­ -->
  <block wx:if="{{!isWorkoutComplete}}">
    <!-- è®­ç»ƒæ ‡é¢˜ -->
    <view class="workout-header">
      <view class="workout-title">{{workoutName}}</view>
      <view class="workout-progress">
        {{currentExerciseIndex + 1}}/{{exercises.length}} åŠ¨ä½œ
      </view>
    </view>
    
    <!-- å½“å‰åŠ¨ä½œ -->
    <view class="current-exercise">
      <image class="exercise-image" src="{{exercises[currentExerciseIndex].image}}" mode="aspectFill"></image>
      <view class="exercise-name">{{exercises[currentExerciseIndex].name}}</view>
      <view class="exercise-muscle">{{exercises[currentExerciseIndex].muscle}}</view>
      
      <view class="set-info">
        <text class="set-label">ç¬¬ {{currentSetIndex + 1}}/{{exercises[currentExerciseIndex].sets}} ç»„</text>
        <text class="rep-label">{{exercises[currentExerciseIndex].reps}}</text>
      </view>
    </view>
    
    <!-- ä¼‘æ¯è®¡æ—¶å™¨ -->
    <view class="rest-timer" wx:if="{{isResting}}">
      <view class="timer-label">ä¼‘æ¯æ—¶é—´</view>
      <view class="timer-value">{{restTimeRemaining}}ç§’</view>
      <button class="skip-button" bindtap="skipRest">è·³è¿‡</button>
    </view>
    
    <!-- ç»„å®ŒæˆæŒ‰é’® -->
    <view class="action-area" wx:if="{{!isResting}}">
      <button class="complete-button" bindtap="completeSet">å®Œæˆæœ¬ç»„</button>
    </view>
    
    <!-- ç»„è¿›åº¦æŒ‡ç¤ºå™¨ -->
    <view class="set-progress">
      <block wx:for="{{exercises[currentExerciseIndex].sets}}" wx:key="index">
        <view class="set-indicator {{index < exercises[currentExerciseIndex].completedSets.length ? 'completed' : (index === currentSetIndex && !isResting ? 'current' : '')}}"></view>
      </block>
    </view>
    
    <!-- è®­ç»ƒåŠ¨ä½œåˆ—è¡¨ -->
    <view class="exercise-list">
      <view class="section-title">è®­ç»ƒåŠ¨ä½œ</view>
      
      <view class="exercise-item {{index === currentExerciseIndex ? 'current' : (index < currentExerciseIndex ? 'completed' : '')}}" 
            wx:for="{{exercises}}" 
            wx:key="id">
        <view class="exercise-header">
          <view class="exercise-status">
            <text class="status-text" wx:if="{{index < currentExerciseIndex}}">å·²å®Œæˆ</text>
            <text class="status-text current" wx:elif="{{index === currentExerciseIndex}}">è¿›è¡Œä¸­</text>
            <text class="status-text" wx:else>å¾…å®Œæˆ</text>
          </view>
          <view class="exercise-info">
            <view class="exercise-name-small">{{item.name}}</view>
            <view class="exercise-sets">{{item.completedSets.length}}/{{item.sets}} ç»„</view>
          </view>
        </view>
      </view>
    </view>
  </block>
  
  <!-- è®­ç»ƒå®Œæˆ -->
  <block wx:else>
    <view class="completion-container">
      <view class="completion-icon">ğŸ‰</view>
      <view class="completion-title">è®­ç»ƒå®Œæˆï¼</view>
      <view class="completion-stats">
        <view class="stat-item">
          <text class="stat-value">{{workoutDuration}}</text>
          <text class="stat-label">åˆ†é’Ÿ</text>
        </view>
        <view class="stat-item">
          <text class="stat-value">{{exercises.length}}</text>
          <text class="stat-label">åŠ¨ä½œ</text>
        </view>
        <view class="stat-item">
                        <text class="stat-value">{{totalSets}}</text>
          <text class="stat-label">ç»„æ•°</text>
        </view>
      </view>
      
      <button class="finish-button" bindtap="finishWorkout">å®Œæˆ</button>
    </view>
  </block>
</view>